### 神经网络中包含哪些超参数？

网路参数:卷积核数量，尺寸，网络深度，激活函数

优化参数:学习率，batch size

正则参数:dropout，权重衰减参数

2. CRF
    CRF学习实体标签之间的约束规则保证标签的合法性。无向图
    条件：给定观测状态的先验条件。（通过相邻位置状态（马尔可夫随机场）和观测状态判断当前位置状态）
    CRF的损失函数是求最优路径的概率占所有路径概率和的比例，目标是最大化整个比例。
    暴力解法求出所有标签排列的概率找最大，当然不可取，CRF采用维特比算法求解。

3. 维特比算法
    是一种动态规划算法，用来求解最有可能产生观测序列的维特比路径（横轴观测序列（文字序列），纵轴隐状态（BIO标签））
在每一时刻，计算当前时刻落在每种隐状态的最大概率，并记录这个最大概率从哪一个隐状态转移过来，最后再从结尾回溯最大概率，得到最有可能的最优路径
    实现：两个暂存表格$T1，T2$
    $T1[i,j]$表示$j$时刻落到隐状态$q_i$的最大概率，$T2[i,j]$表示最大概率从第$j-1$时刻的哪种隐状态$q_i$转移过来的，第0时刻$T2$为$NAN$，乘法取对数变加法
    时间复杂度$O(TN^2)$
    
4. HMM
    是概率图模型的一种，属于生成模型，描述由隐状态序列生成可观测状态的过程。

    有向无环图。预测天气的温度，温度变化是隐状态，雪糕销量是观测状态，通过转移概率矩阵和观测概率矩阵预测是为HMM模型，是为生成模型
    直接通过前一天的温度预测当前温度，是为判别模型P(Y|X)

    -------

    模型参数：$(\pi,A,B)$

    观测序列：$O = (o_1,o_2,...,o_T)$

    隐状态序列：$I = (i_1,i_2,...,i_T)$

    - 三个基本问题：概率计算（已知模型和观测序列，计算该模型下观测序列出现的概率），参数学习（已知观测序列，估计模型的参数，（不包含对应的状态序列，采用非监督学习算法，EM算法，包含对应的状态序列，监督学习，极大似然估计），解码问题(已知模型参数和观测序列，求最大概率的隐状态序列，维特比算法)
    - 两个假设：一阶马尔科夫假设，当前状态与前一时刻状态有关；观测独立假设，当前观测与当前时刻状态有关。

    - HMM参数学习：极大似然估计（统计思想，极大频率即概率）进行监督学习

      1）初始状态概率的估计

      ​	<font size=5>$\hat \pi_{q_i} = \frac{count(q_i^1)}{count(o_1)}$  </font>                                                       <font size=4> $\sum_i\pi_{q_i}=1$</font>

      2）转移概率的估计

      <font size=4>$\hat A_{ij} = P(i_{t+1} = q_j|i_t = q_i) =  \frac{count(q_iq_j)}{count(q_i)}$  </font>                   <font size=4> $\sum_j A_{ij}=\sum_j P(i_{t+1} = q_j|i_t = q_i) = 1$</font>

      3）发射概率的估计

      <font size=4>$\hat B_{jk} = P(o_t = v_k|i_t = q_j) =  \frac{count(q_jv_k)}{count(q_j)}$  </font>                              <font size=4> $\sum_k B_{jk}=\sum_k  P(o_t = v_k|i_t = q_j) = 1$</font>
      ---

    - 预测用HMM解决序列标注问题

      ![image-20210118171248118](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20210118171248118.png)

    

5. 判别模型VS生成模型
    判别模型：对P(Y|X)建模，根据输入的特征，预测标签，计算损失，学习参数，如LR，CRF，速度快
    生成模型：对联合概率P(X,Y)建模，P(X,Y) = P(X|Y)P(Y)，P(Y|X) = P(X,Y)/P(X)，速度慢

6. Attention
    表示重要性的权重向量

7. Seq2Seq
    任意长度源序列转化为目标序列任务，如常见的机器翻译和语音识别
    经典架构模型：Encoder-Decoder

    - RNN Encoder-Decoder
      核心特征在最后一层
      ![image-20210124163535576](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20210124163535576.png)
    
      将变长源序列X编码成定长向量c，并将c解码成变成变长目标序列Y。
      编码器和解码器联合训练，以最大化给定源序列的目标序列的条件概率。
    
    - Attention Encoder-Decoder
      ![image-20210124165337815](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20210124165337815.png)
    
      RNN 定长C表示能力有限（只在最后一刻），因此提出Attention，对每一时刻的加权隐藏特征解码
    
      权重理解为系数（先计算数值再softmax），计算打分函数方法多种多样。
    
    - Attention 
    
      - soft Attention
        ![image-20210124174642131](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20210124174642131.png)
    
        - 在输入信息上计算注意力分布
          根据注意力分布计算输入信息的加权平均(softmax)
          $\alpha_i = softmax(s(x_i,q))$ （先和q计算打分，又和它进行加权平均）
          $\alpha_i$称为注意力分布（可以理解为选中的概率，也可以理解为提取的信息占比）
          $s(x_i,q)$成为注意力打分函数($x_i$可理解为上图中的$h_i$，q可理解为上图中的$s_{t-1}$)
          打分函数计算方式：
        - 求和模型：$s(x_i,q)= V^T tanh(Wx_i  \ + Uq)$ 
        - 缩放点积模型：$s(x_i,q)= \frac{x_i^T q}{\sqrt d}$    (d为输入信息的维度，序列长度，为了模型更加稳定，序列较长时，点积运算方差较大（数值偏离程度较大，比如100,0,-100的方差比1,0,-1大），进行softmax运算(指数次方)信息会集中在大数值上，造成梯度较小，缩放点积可以降低方差（类似于归一化）)，点积可以利用矩阵乘积，计算效率高
    
      - 键值对注意力机制    
        ![image-20210124174608062](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20210124174608062.png)
        
      - 自注意力机制 
      $Q = W_Q X$  查询向量序列
      $K = W_K X$  键向量序列
      $V = W_V X$  值向量序列
        
      
      $W_Q,W_K,W_V $为可学习参数矩阵
      
      
    
8. transformer
   
    注意力机制丢失了位置信息(单词的前后关系)
    
    输入序列词嵌入Embedding , 维度(N*d）
    
    输入序列位置编码pos_emd ,维度(N*d)  (位置序号使用偶数位置sin和奇数位置cos函数)
    
    输入序列：序列序号
    目标序列：decode最上面那个$[t_1,t_2,···，t_q，t_{q+1},t_n]$
    
    outputs序列:decode最下面那个[$t_1,t_2,···,t_{q-1}$]
    
    $Attention(Q,K,V) = softmax(\frac{QK^T}{\sqrt{d_k}}) V$
    
    ![image-20210124183114335](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20210124183114335.png)
    
9.  bert

    ![image-20210124185733963](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20210124185733963.png)